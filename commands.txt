
## CENTOS 
#yum -y install git java maven yum-utils
#yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
#yum-config-manager --add-repo  https://download.docker.com/linux/rhel/docker-ce.repo
#yum -y install docker-ce docker-ce-cli containerd.io docker-compose-plugin
#ln -s /usr/libexec/docker/cli-plugins/docker-compose /usr/local/bin/
#systemctl start docker

## UBUNTU
#apt-get update
apt-get install git
#apt-get install jdk*
#apt-get install maven
#update-alternatives --config java
#apt install docker*

#usermod -a -G docker <user>

export SR_ROOT=/root
export SR_DIR=${SR_ROOT}/selective-reprocessing

cd ${SR_ROOT}
git clone https://github.com/doc-ti/selective-reprocessing.git

mkdir flume-input

cd ${SR_DIR}/java-flume
mvn clean install

cd ${SR_DIR}/java-storm
mvn clean install assembly:single

cd ${SR_DIR}
ln -s ../java-flume/target/plugin-flume-1.0.0.jar flume-conf/
ln -s ../java-storm/target/storm-test-1.2.2-dep.jar storm/

cd ${SR_DIR}
docker-compose up -d

FFF=data.txt.`date +%Y%m%d_%H%M%S`
for NN in `seq 1 100`
do
  echo $NN,$RANDOM
done > $FFF

mv $FFF flume-input/

docker exec -it kafka kafka-console-consumer.sh --bootstrap-server kafka:9092 --topic topic_data --from-beginning


