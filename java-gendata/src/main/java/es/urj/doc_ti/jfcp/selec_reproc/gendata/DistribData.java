package es.urj.doc_ti.jfcp.selec_reproc.gendata;

import java.util.ArrayList;
import java.util.Random;

import net.datafaker.Faker;
import net.datafaker.providers.base.BaseProviders;

public class DistribData {

	int maxVal ;
	
	ArrayList<String>  arrN = new ArrayList<String>() ;
	ArrayList<Integer> arrV = new ArrayList<Integer>() ;

	
	public void add(String[] names, int[] vals) {
		maxVal = 0 ;
		
    	for ( int index = 0 ; index < names.length; index++) {
    		arrN.add(names[index]) ;
    		maxVal += vals[index] ;
    		arrV.add(maxVal) ;
    	}
	}
	
	public void addIpsWithExponential(int number, double lambda, int seed) {
		
		Random generator = new Random(seed);
		Faker fk = new Faker(generator) ;

		double mylamda = lambda<1 ? 1 : lambda ;
	    
    	for ( int index = 0 ; index < number; index++) {
    		
    		long num = 0 ;
    		while ( num <= 0 ) {
    			num = Math.round( -mylamda * Math.log(1-generator.nextDouble()) )  ;
    		}
    		
    		arrN.add(fk.internet().ipV4Address()) ;
    		maxVal += num ;
    		arrV.add(maxVal) ;
    	}
    	
    	System.out.println (arrV) ;
    	System.out.println (arrN) ;
	}
	
	
	/*
CAMPO: 3 --------
1
4038471 18

CAMPO: 4 --------
461251
  11011 214042391120299
   7832 214040123000674
   4328 214042381040049

CAMPO: 5 --------
690
1284284 217.168.4.32
 814334 217.168.3.33
 581595 217.168.14.129
 578858 217.168.12.33
 433835 217.168.4.144
 196427 217.168.4.128
  47877 83.231.29.97
  15036 83.231.28.155
  14205 83.231.28.154
  11448 80.10.111.17
   5764 62.169.89.125
   4537 62.169.89.140
   1982 83.231.29.120
   1047 176.241.252.28
   1000 80.10.3.110
    957 83.231.28.2
    930 176.241.253.28
    867 213.143.40.1
    863 213.143.41.1
    821 213.143.41.105

--
CAMPO: 6 --------
784719
  11011 2072438225
   7832 2162387639
   4313 608746135
--
CAMPO: 7 --------
1
4038471 10.31.42.8

CAMPO: 8 --------
371
3053495 internet
 401735 datos
 283531 internet.mundo-r.com
 203432 ims
  10776 internet.telecable.es
   8219 info.m2mcubic.com
   7211 umts
   6498 inet.es
   5659 orangeworld
   5080 internetmas
   4761 data.lycamobile.es
   4482 wifi.m2mcubic.com

--
CAMPO: 9 --------
2
4035032 65281
   3439 65282

CAMPO: 10 --------
709784
  11011 100.70.100.115
   7832 172.16.7.145
   4313 100.78.175.43
   4309 10.61.24.23
   4131 100.81.91.214
   3439 0.0.0.0
   2548 100.69.152.33
   2461 10.9.155.17
   2414 10.18.3.62
   2133 10.116.61.64
   2077 10.56.38.169
   2027 172.16.182.137
   1989 10.57.36.105
   1812 10.224.125.74
   1714 10.207.235.248
   1648 10.9.204.145
   1393 10.198.21.245
   1345 100.81.221.80
   1308 10.14.43.67
   1207 100.81.158.110
--
CAMPO: 11 --------
1
4038471 1

CAMPO: 12 --------
1
4038471

CAMPO: 13 --------
1
4038471

CAMPO: 14 --------
1
4038471

CAMPO: 15 --------
1
4038471

CAMPO: 16 --------
1
4038471

CAMPO: 17 --------
1
4038471 0

CAMPO: 18 --------
1
4038471 0

CAMPO: 19 --------
1
4038471 0

CAMPO: 20 --------
1
4038471 0

CAMPO: 21 --------
1
4038471 0

CAMPO: 22 --------
728873
 540385 0
   8102 52
   8015 132
   5674 40
   5309 128
   5060 120
   4811 104
   4642 116
   4077 144
   3140 80
   3055 208
   3026 70
   2818 254
   2709 156
   2706 194
   2686 180
   2458 130
   2434 245
   2180 260
   1975 185
   1856 249
   1823 160
   1792 256

--
CAMPO: 23 --------
1056460
 500536 0
  16676 40
   7323 130
   5879 80
   5114 52
   5112 76
   4309 128
   3946 104
   3493 105
   3351 91
   3172 198
   3164 156
   2923 120
   2916 4160
   2702 197
   2443 64
   2360 208
   2294 286
   2262 195
   2049 78
   2001 202
   1939 98
   1912 192
   1799 260
   1730 96
   1727 377
   1669 160

--
CAMPO: 24 --------
1
4038471 2

CAMPO: 25 --------
3651
   1251 230120161645+0100
   1244 230120164712+0100
   1236 230120163255+0100
   1234 230120163323+0100
   1234 230120162625+0100
   1228 230120164618+0100
   1228 230120163230+0100
   1227 230120165121+0100
   1227 230120162205+0100

--
CAMPO: 26 --------
26413
   1215 230120160724+0100
   1206 230120160723+0100
   1188 230120160722+0100
--
CAMPO: 27 --------
22941
 128790 3
 125391 1
 122453 2
 112563 4
  87572 5
  84504 12
  77297 8
  76557 6
  65177 7
  63524 9
  62538 10
  61608 11
  48249 0
  44670 13
  42496 14
  41739 15
  37398 16
  35589 20
  34898 22
  33737 23
  32851 21

--
CAMPO: 28 --------
4
2340074 16
1695310 0
   2300 17
    787 18

--
CAMPO: 29 --------
22561
1690040 1
 120888 2
  89807 3
  74011 4
  64013 5
  56684 6
  51135 7
  46663 8
  42940 9
  39809 10
  37004 11
  34741 12
  32734 13
  30834 14
  29242 15
  27816 16
  26470 17
  25356 18
  24276 19
  23248 20

--
CAMPO: 30 --------
1
4038471 GAL01SGW01

CAMPO: 31 --------
461246
  11011 34604054860
   7832 34617269886
   4328 34604019629
--
CAMPO: 32 --------
1
4038471

CAMPO: 33 --------
1
4038471

CAMPO: 34 --------
1
4038471

CAMPO: 35 --------
12288
  11413 214030914873012
   8544 214030881670001
   7733 214030600104011
--
CAMPO: 36 --------
1
4038471

CAMPO: 37 --------
1
4038471

CAMPO: 38 --------
1
4038471

CAMPO: 39 --------
1
4038471

CAMPO: 40 --------
1
4038471

CAMPO: 41 --------
7
3169134 08
 659245 008C
 167812 05
  27169 01
   7170 06
   4317 07
   3624 09

--
CAMPO: 42 --------
1
4038471 0

CAMPO: 43 --------
1
4038471

CAMPO: 44 --------
1
4038471

CAMPO: 45 --------
1
4038471

CAMPO: 46 --------
1
4038471

CAMPO: 47 --------
1
4038471

CAMPO: 48 --------
1
4038471 6

CAMPO: 49 --------
461374
  11011 3570562307960401
   7832 8637540455304400
   4328 3582753807166714
   4309 8657120367045301
   4131 3536171121237947
   2960 8646540514992660
   2548 8678700416583200
   2464 3578468551884915
   2414 8660230401517119
   2133 8695470430316003
   2077 8675600392255300
   2027 3539817614246306
   1989 8665010478607701
   1831 3583208019434401
   1714 8628070516255074

--
CAMPO: 50 --------
84474
3901024 0
   1167 52
    497 104
    466 70
    330 40
    276 128
    255 76
    207 64
    203 156
    195 78
    188 58
    182 116
    168 120
    162 143
    153 144
    141 60
    137 208
    137 168
    132 152
    122 80
    109 1260
    100 180
     95 91
     91 228
     89 621
     85 304
     84 185
     82 312

--
CAMPO: 51 --------
129168
3892118 0
    579 52
    384 104
--
CAMPO: 52 --------
11443
3866879
     71 20230120160818
     69 20230120160500
--
CAMPO: 53 --------
2598
3869902 0
   6184 10
   3787 11
   3031 1
   2393 12
   2386 3
   2367 2
   2131 13
   2020 14
   1950 6
   1915 15
   1882 20
   1844 5
   1794 8
   1792 16
   1791 7
   1779 21
   1765 4
   1717 17
   1689 9
   1629 30
   1621 29
   1612 18
   1582 27
   1564 22
   1527 28
   1503 23

--
CAMPO: 54 --------
2
3866879
 171592 5G


	 */
	
	public String searchNext(BaseProviders faker) {
		
		int valMax = faker.random().nextInt(0, maxVal-1) ;
		
    	for ( int index = 0 ; index < arrN.size(); index++) {
    		if ( arrV.get(index) > valMax ) {
    			return arrN.get(index) ;
    		}
    	}
		
		return "N/F";
	}
	
	
}
